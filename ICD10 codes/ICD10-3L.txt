> icd3_top <- icd %>% group_by(c3) %>% summarise( n= n(),
+ perc = round(n/nrow(df) * 100,digits=2),
+ alc_perc_grp = mean(alc_n) * 100) %>%
+ arrange(desc(alc_perc_grp)) %>% filter(n > 1000) %>% print(n=200)
Source: local data frame [163 x 4]

       c3     n  perc alc_perc_grp
    (chr) (int) (dbl)        (dbl)
1     F03  5735  0.38   48.9799477
2     Z74  1521  0.10   43.6554898
3     Z73  6355  0.42   40.3776554
4     S32 12056  0.79   37.2345720
5     R64  9160  0.60   37.0742358
6     M96  1289  0.08   36.1520559
7     R29 10134  0.66   35.9680284
8     G20  1208  0.08   35.4304636
9     S42  6484  0.42   33.3127699
10    S79  1277  0.08   33.1245106
11    S72 62382  4.08   30.6097913
12    S70  1171  0.08   29.9743809
13    Z04  1440  0.09   29.7916667
14    S82 10265  0.67   28.8455918
15    R26  1594  0.10   27.9171895
16    M62  1700  0.11   26.8235294
17    F05 15589  1.02   25.5628969
18    S39  1010  0.07   25.2475248
19    M48  1062  0.07   24.8587571
20    S00  1092  0.07   23.6263736
21    S12  2275  0.15   23.4725275
22    R53 29221  1.91   23.1751138
23    S22  6177  0.40   21.8552695
24    R41 21374  1.40   21.5355104
25    M79  4380  0.29   21.2328767
26    M54 10608  0.69   21.1915535
27    I63 23399  1.53   21.0906449
28    S52  4072  0.27   20.6777996
29    S09  3568  0.23   20.5437220
30    S01  2610  0.17   20.3448276
31    M25  4943  0.32   20.0283229
32    I61  6023  0.39   19.4089324
33    I64 25226  1.65   18.9526679
34    S02  1237  0.08   18.5125303
35    C61  1095  0.07   17.8995434
36    T84  2670  0.17   16.8539326
37    S06 12980  0.85   16.6255778
38    C71  1024  0.07   16.4062500
39    R60  2574  0.17   16.0450660
40    I62  5784  0.38   15.8367911
41    C79  3525  0.23   15.8014184
42    M86  1055  0.07   15.7345972
43    G93  1145  0.07   15.2838428
44    E86  9736  0.64   14.8829088
45    Z51  6175  0.40   13.6518219
46    F10  2623  0.17   13.6484941
47    E83  2289  0.15   13.6304063
48    C34  5605  0.37   13.5593220
49    E14  3806  0.25   13.4524435
50    N39 48216  3.16   13.0682761
51    R40  1152  0.08   12.9340278
52    L03 14863  0.97   12.8910718
53    N19  2568  0.17   12.8894081
54    N18  1619  0.11   12.6621371
55    I70  1091  0.07   12.6489459
56    R56  6165  0.40   12.5060827
57    I60  1972  0.13   12.4746450
58    D43  1225  0.08   12.4081633
59    C18  1736  0.11   12.0391705
60    E10  1347  0.09   12.0267261
61    E11 12219  0.80   11.7931091
62    S27  1291  0.08   11.6963594
63    K74  1119  0.07   11.6175156
64    A04  2925  0.19   11.5213675
65    M00  1689  0.11   11.4860864
66    C25  1688  0.11   11.3744076
67    N17 21262  1.39   11.1889756
68    R52  2379  0.16   11.1391341
69    C78  2698  0.18   11.0081542
70    R57  2408  0.16   11.0049834
71    I99  2141  0.14   10.7893508
72    J96  6115  0.40   10.3352412
73    K59  3820  0.25   10.2879581
74    K63  2552  0.17   10.1880878
75    A41 30785  2.02   10.1607926
76    G40  2511  0.16   10.0756671
77    I80  2507  0.16    9.9720782
78    E87 21118  1.38    9.8067999
79    J84  2670  0.17    9.7752809
80    K72  2344  0.15    9.7696246
81    R19  1187  0.08    9.6040438
82    I95  4564  0.30    9.5968449
83    J06  1935  0.13    9.5090439
84    M10  1097  0.07    8.8422972
85    R18  2007  0.13    8.8191330
86    R13  2699  0.18    8.8180808
87    J18 73861  4.84    8.8016680
88    Z71  1391  0.09    8.6987779
89    G45  9938  0.65    8.5731536
90    A09 14955  0.98    8.4854564
91    R09  2257  0.15    8.3739477
92    J69  6642  0.43    8.2806384
93    J90  8998  0.59    8.2129362
94    R17  1705  0.11    8.0938416
95    J40  1336  0.09    8.0838323
96    D64 14493  0.95    8.0797626
97    R55 24513  1.61    8.0406315
98    I35  1045  0.07    8.0382775
99    J98  1612  0.11    7.9404467
100   I50 80905  5.30    7.9179284
101   R06 22701  1.49    7.8410643
102   R51  1850  0.12    7.8378378
103   R33  4590  0.30    7.6252723
104   J11  1640  0.11    7.6219512
105   R50 14835  0.97    7.6171217
106   R42  9906  0.65    7.6115486
107   I74  1556  0.10    7.5835476
108   R11  8745  0.57    7.3527730
109   K65  1879  0.12    7.2378925
110   H81  1474  0.10    6.9877883
111   I10  4908  0.32    6.2550937
112   J44 70462  4.61    6.0472311
113   J81  3296  0.22    6.0376214
114   L02  1220  0.08    5.9836066
115   K55  2772  0.18    5.9163059
116   I71  3872  0.25    5.6818182
117   R10 27581  1.81    5.6053080
118   D50  1447  0.09    5.3904630
119   I48 30074  1.97    5.3501363
120   K83  4944  0.32    5.2791262
121   A49  1563  0.10    5.2463212
122   I26  6531  0.43    5.1600061
123   K43  1917  0.13    5.1121544
124   N12  3589  0.24    4.9317359
125   I46  5274  0.35    4.8919226
126   T83  1311  0.09    4.8054920
127   K92 41304  2.70    4.7695138
128   K56 40450  2.65    4.7515451
129   J93  1930  0.13    4.7150259
130   K22  1061  0.07    4.6182846
131   I25  1711  0.11    4.4418469
132   T85  1721  0.11    4.4160372
133   T81 11523  0.75    4.3304695
134   R94 33566  2.20    4.2960138
135   I44  5923  0.39    4.2714840
136   K40  2840  0.19    4.2605634
137   I49  3805  0.25    4.1261498
138   R00 10992  0.72    4.0847889
139   I45  1253  0.08    4.0702314
140   D69  1068  0.07    3.9325843
141   I21 20212  1.32    3.8195132
142   I24 23890  1.56    3.6709920
143   K57  8336  0.55    3.6708253
144   K62  8283  0.54    3.6701678
145   R31 11290  0.74    3.6581045
146   T82  2232  0.15    3.6290323
147   K91  1981  0.13    3.5335689
148   I31  1333  0.09    3.4508627
149   D70  4948  0.32    3.4155214
150   R04  4852  0.32    3.3182193
151   R07 24680  1.62    3.2090762
152   J45  3307  0.22    3.1448443
153   K85 12832  0.84    3.0392768
154   T78  1238  0.08    2.9886914
155   N13  3270  0.21    2.9663609
156   I47  5309  0.35    2.8818987
157   K81  9597  0.63    2.6362405
158   K80  9260  0.61    2.5269978
159   K37  1860  0.12    1.7204301
160   N23  1900  0.12    1.6315789
161   I20 19954  1.31    1.4733888
162   N20  2501  0.16    1.2395042
163   K35  4496  0.29    0.9564057